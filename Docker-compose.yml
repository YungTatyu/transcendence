version: '3'
services:
  auth:
    build: ./auth_service
    ports:
      - "8000:8000"
    networks:
      - app_network
    depends_on:
      - auth_db
    environment:
      - DJANGO_DB_NAME=auth_db
      - DJANGO_DB_USER=auth_user
      - DJANGO_DB_PASSWORD=auth_password
      - DJANGO_DB_HOST=auth_db
      - DJANGO_DB_PORT=5432

  auth_db:
    image: postgres:15
    container_name: auth_db
    environment:
      POSTGRES_USER: auth_user
      POSTGRES_PASSWORD: auth_password
      POSTGRES_DB: auth_db
    networks:
      - app_network
    volumes:
      - auth_db_data:/var/lib/postgresql/data

  sample1:
    build: ./sample_api_service
    ports:
      - "8001:8001"
    depends_on:
      - auth
      - sample1_db
    networks:
      - app_network
    environment:
      - DJANGO_DB_NAME=sample1_db
      - DJANGO_DB_USER=sample1_user
      - DJANGO_DB_PASSWORD=sample1_password
      - DJANGO_DB_HOST=sample1_db
      - DJANGO_DB_PORT=5432

  sample1_db:
    image: postgres:15
    container_name: sample1_db
    environment:
      POSTGRES_USER: sample1_user
      POSTGRES_PASSWORD: sample1_password
      POSTGRES_DB: sample1_db
    networks:
      - app_network
    volumes:
      - sample1_db_data:/var/lib/postgresql/data

networks:
  app_network:
    driver: bridge

volumes:
  auth_db_data:
  sample1_db_data: